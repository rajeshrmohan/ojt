<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Support Hub</title>
    
    <!-- PWA Manifest and Theme -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">

    <!-- Apple-specific PWA tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">

    <style>
        /* --- General Styles (Unchanged) --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: #333; }
        .container { max-width: 100%; padding: 0; min-height: 100vh; }
        .header { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); padding: 20px; text-align: center; box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 100; }
        .nav-tabs { display: flex; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); position: sticky; top: 80px; z-index: 99; border-bottom: 1px solid #e2e8f0; }
        .nav-tab { flex: 1; padding: 15px 10px; text-align: center; background: none; border: none; cursor: pointer; font-size: 0.8rem; font-weight: 500; color: #718096; transition: all 0.3s ease; border-bottom: 3px solid transparent; }
        .nav-tab.active { color: #667eea; border-bottom-color: #667eea; background: rgba(102, 126, 234, 0.1); }
        .tab-content { display: none; padding: 20px; animation: fadeIn 0.3s ease; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card { background: white; border-radius: 15px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 25px rgba(0, 0, 0, 0.1); }
        .card h3 { color: #4a5568; margin-bottom: 15px; font-size: 1.2rem; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #4a5568; }
        .form-input, .form-textarea { width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem; transition: border-color 0.3s ease; }
        .form-input:focus, .form-textarea:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
        .form-textarea { resize: vertical; min-height: 120px; }
        .btn { width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 10px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .empty-state { text-align: center; padding: 40px 20px; color: #718096; }
        .item-actions { position: absolute; top: 50%; right: 15px; transform: translateY(-50%); display: flex; gap: 10px; opacity: 0; transition: opacity 0.2s ease-in-out; }
        .list-item:hover .item-actions { opacity: 1; }
        .action-btn { background: #f1f5f9; border: none; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; display: flex; align-items: center; justify-content: center; color: #64748b; transition: all 0.2s ease; }
        .action-btn:hover { background: #e2e8f0; transform: scale(1.1); }
        .action-btn.delete-btn:hover { background: #fee2e2; color: #dc2626; }
        .list-item { position: relative; }
        .checklist-item { display: flex; align-items: center; padding: 12px 5px; border-bottom: 1px solid #f7fafc; }
        .checklist-text { flex: 1; font-size: 0.95rem; line-height: 1.4; padding-right: 80px; }
        .checkbox { width: 20px; height: 20px; margin-right: 15px; accent-color: #667eea; cursor: pointer; flex-shrink: 0; }
        .checkbox:checked + .checklist-text { text-decoration: line-through; color: #a0aec0; }
        .progress-bar { width: 100%; height: 8px; background: #e2e8f0; border-radius: 4px; margin: 15px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); transition: width 0.5s ease; }
        .reflection-item { background: #f8f9ff; padding: 15px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #667eea; }
        .reflection-date { font-size: 0.8rem; color: #718096; margin-bottom: 5px; }
        .reflection-title { font-weight: 600; color: #4a5568; margin-bottom: 8px; }
        .contact-card { display: flex; align-items: center; padding: 15px; background: white; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08); }
        .contact-avatar { width: 50px; height: 50px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.2rem; margin-right: 15px; flex-shrink: 0; }
        .contact-info { flex-grow: 1; }

        /* --- UPDATED STYLE FOR CONTACTS --- */
        .contact-links {
            margin-left: auto;
            display: flex;
            gap: 10px;
            align-items: center; /* This line vertically aligns all buttons */
        }
        .contact-btn { padding: 8px 12px; background: #667eea; color: white; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer; text-decoration: none; }
        
        .notification { background: #f0fff4; border-left: 4px solid #48bb78; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .notification-header { font-weight: 600; color: #22543d; margin-bottom: 5px; padding-right: 80px; }
        .badge { display: inline-block; padding: 4px 8px; background: #667eea; color: white; border-radius: 12px; font-size: 0.7rem; font-weight: 500; }
    </style>
</head>
<body>
    <!-- The entire body HTML is unchanged -->
    <div class="container">
        <div class="header"><h1>Student Support Hub</h1><p>Your On-the-Job Training Companion</p></div>
        <div class="nav-tabs">
            <button id="btn-checklist" class="nav-tab active" onclick="showTab('checklist')">Checklist</button>
            <button id="btn-reflections" class="nav-tab" onclick="showTab('reflections')">Reflections</button>
            <button id="btn-contacts" class="nav-tab" onclick="showTab('contacts')">Contacts</button>
            <button id="btn-notifications" class="nav-tab" onclick="showTab('notifications')">Alerts</button>
        </div>
        <div id="checklist" class="tab-content active">
            <div class="card">
                <h3>OJT Progress Tracker</h3>
                <div class="progress-bar"><div class="progress-fill" id="progressBar"></div></div>
                <p style="text-align: center; margin-bottom: 20px;"><span id="completedCount">0</span> of <span id="totalCount">0</span> tasks completed</p>
                <div id="checklistItems"></div>
                <div style="margin-top: 20px;">
                    <div class="form-group"><label for="newTask">Add New Task:</label><input type="text" id="newTask" class="form-input" placeholder="Enter a new task..."></div>
                    <button class="btn" onclick="addTask()">Add Task</button>
                </div>
            </div>
        </div>
        <div id="reflections" class="tab-content">
            <div class="card">
                <h3 id="reflectionFormTitle">Submit Reflection</h3>
                <input type="hidden" id="reflectionEditId">
                <div class="form-group"><label for="reflectionTitle">Title:</label><input type="text" id="reflectionTitle" class="form-input"></div>
                <div class="form-group"><label for="reflectionContent">Reflection:</label><textarea id="reflectionContent" class="form-textarea"></textarea></div>
                <button class="btn" id="reflectionSubmitBtn" onclick="addOrUpdateReflection()">Save Reflection</button>
            </div>
            <div class="card"><h3>Previous Reflections</h3><div id="reflectionsList"></div></div>
        </div>
        <div id="contacts" class="tab-content">
             <div class="card">
                <h3>Key Contacts</h3>
                <div id="contactsList"></div>
            </div>
            <div class="card">
                <h3 id="contactFormTitle">Add New Contact</h3>
                <input type="hidden" id="contactEditId">
                <div class="form-group"><input type="text" id="contactName" class="form-input" placeholder="Name"></div>
                <div class="form-group"><input type="text" id="contactRole" class="form-input" placeholder="Role (e.g., Mentor, HR)"></div>
                <div class="form-group"><input type="email" id="contactEmail" class="form-input" placeholder="Email"></div>
                <div class="form-group"><input type="tel" id="contactPhone" class="form-input" placeholder="Phone"></div>
                <button class="btn" id="contactSubmitBtn" onclick="addOrUpdateContact()">Add Contact</button>
            </div>
        </div>
        <div id="notifications" class="tab-content">
            <div class="card">
                <h3>Important Deadlines & Notifications</h3>
                <div id="notificationsList"></div>
            </div>
            <div class="card">
                <h3 id="reminderFormTitle">Add Reminder</h3>
                <input type="hidden" id="reminderEditId">
                <div class="form-group"><label for="reminderTitle">Title:</label><input type="text" id="reminderTitle" class="form-input" placeholder="Reminder title"></div>
                <div class="form-group"><label for="reminderDate">Date & Time:</label><input type="datetime-local" id="reminderDate" class="form-input"></div>
                <div class="form-group"><label for="reminderNote">Notes:</label><textarea id="reminderNote" class="form-textarea" placeholder="Additional notes..."></textarea></div>
                <button class="btn" id="reminderSubmitBtn" onclick="addOrUpdateReminder()">Set Reminder</button>
            </div>
        </div>
    </div>

    <!-- Script section contains the fix -->
    <script>
        // --- DATA MANAGEMENT & INITIALIZATION (Unchanged) ---
        let appData = {};
        function loadData() { const stored = JSON.parse(localStorage.getItem('studentSupportData') || '{}'); appData = { tasks: stored.tasks || [{ id: Date.now(), text: "Complete workplace orientation", completed: false }], reflections: stored.reflections || [], contacts: stored.contacts || [{ id: Date.now(), name: "Dr. Sarah Johnson", role: "Academic Supervisor", email: "s.johnson@university.edu", phone: "91234567" }], notifications: stored.notifications || [{ id: Date.now(), title: "Mid-term Evaluation Due", date: "2025-09-15T09:00", note: "Submit report" }] }; }
        function saveData() { localStorage.setItem('studentSupportData', JSON.stringify(appData)); }
        function init() { loadData(); renderAll(); }
        function renderAll() { renderTasks(); renderReflections(); renderContacts(); renderNotifications(); }
        function showTab(tabName) { document.querySelectorAll('.tab-content, .nav-tab').forEach(el => el.classList.remove('active')); document.getElementById(tabName).classList.add('active'); document.getElementById(`btn-${tabName}`).classList.add('active'); }
        
        // --- CHECKLIST & PROGRESS (Unchanged) ---
        function renderTasks() { const container = document.getElementById('checklistItems'); container.innerHTML = appData.tasks.length === 0 ? `<div class="empty-state">No tasks yet.</div>` : ''; appData.tasks.forEach(task => { const item = document.createElement('div'); item.className = 'list-item checklist-item'; item.innerHTML = ` <input type="checkbox" class="checkbox" id="task-${task.id}" ${task.completed ? 'checked' : ''} onchange="toggleTask(${task.id})"> <label for="task-${task.id}" class="checklist-text">${task.text}</label> <div class="item-actions"> <button class="action-btn" onclick="editTask(${task.id})">✏️</button> <button class="action-btn delete-btn" onclick="deleteTask(${task.id})">🗑️</button> </div>`; container.appendChild(item); }); updateProgress(); }
        function addTask() { const input = document.getElementById('newTask'); const text = input.value.trim(); if (text) { appData.tasks.push({ id: Date.now(), text, completed: false }); input.value = ''; saveData(); renderTasks(); } }
        function editTask(id) { const task = appData.tasks.find(t => t.id === id); const newText = prompt('Edit your task:', task.text); if (newText && newText.trim() !== '') { task.text = newText.trim(); saveData(); renderTasks(); } }
        function deleteTask(id) { if (confirm('Are you sure you want to delete this task?')) { appData.tasks = appData.tasks.filter(t => t.id !== id); saveData(); renderTasks(); } }
        function toggleTask(id) { const task = appData.tasks.find(t => t.id === id); if (task) { task.completed = !task.completed; saveData(); updateProgress(); } }
        function updateProgress() { const total = appData.tasks.length; const completed = appData.tasks.filter(t => t.completed).length; const percentage = total > 0 ? (completed / total) * 100 : 0; document.getElementById('progressBar').style.width = percentage + '%'; document.getElementById('completedCount').textContent = completed; document.getElementById('totalCount').textContent = total; }
        
        // --- REFLECTIONS (Unchanged) ---
        function renderReflections() { const container = document.getElementById('reflectionsList'); container.innerHTML = appData.reflections.length === 0 ? `<div class="empty-state">No reflections yet.</div>` : ''; [...appData.reflections].reverse().forEach(r => { const item = document.createElement('div'); item.className = 'list-item reflection-item'; item.innerHTML = ` <div class="item-actions"> <button class="action-btn" onclick="editReflection(${r.id})">✏️</button> <button class="action-btn delete-btn" onclick="deleteReflection(${r.id})">🗑️</button> </div> <div class="reflection-date">${new Date(r.date).toLocaleDateString()}</div> <div class="reflection-title">${r.title}</div> <div class="reflection-content">${r.content.replace(/\n/g, '<br>')}</div>`; container.appendChild(item); }); }
        function addOrUpdateReflection() { const title = document.getElementById('reflectionTitle').value.trim(); const content = document.getElementById('reflectionContent').value.trim(); const id = parseInt(document.getElementById('reflectionEditId').value); if (!title || !content) return; if (id) { const reflection = appData.reflections.find(r => r.id === id); Object.assign(reflection, { title, content }); } else { appData.reflections.push({ id: Date.now(), title, content, date: new Date().toISOString() }); } resetReflectionForm(); saveData(); renderReflections(); }
        function editReflection(id) { const r = appData.reflections.find(r => r.id === id); document.getElementById('reflectionFormTitle').innerText = 'Edit Reflection'; document.getElementById('reflectionEditId').value = r.id; document.getElementById('reflectionTitle').value = r.title; document.getElementById('reflectionContent').value = r.content; document.getElementById('reflectionSubmitBtn').innerText = 'Update Reflection'; document.getElementById('reflectionTitle').focus(); }
        function deleteReflection(id) { if (confirm('Delete this reflection?')) { appData.reflections = appData.reflections.filter(r => r.id !== id); saveData(); renderReflections(); } }
        function resetReflectionForm() { document.getElementById('reflectionFormTitle').innerText = 'Submit Reflection'; document.getElementById('reflectionSubmitBtn').innerText = 'Save Reflection'; document.getElementById('reflectionEditId').value = ''; document.getElementById('reflectionTitle').value = ''; document.getElementById('reflectionContent').value = ''; }
        
        // --- CONTACTS (FUNCTION UPDATED) ---
        function renderContacts() {
            const container = document.getElementById('contactsList');
            container.innerHTML = appData.contacts.length === 0 ? `<div class="empty-state">No contacts added.</div>` : '';
            appData.contacts.forEach(c => {
                const item = document.createElement('div');
                // The 'list-item' class is removed here as we don't need the hover effect
                item.className = 'contact-card';
                item.innerHTML = `
                    <div class="contact-avatar">${c.name.charAt(0).toUpperCase()}</div>
                    <div class="contact-info"><h4>${c.name}</h4><p>${c.role}</p></div>
                    <div class="contact-links">
                        ${c.email ? `<a href="mailto:${c.email}" class="contact-btn">Email</a>` : ''}
                        ${c.phone ? `<a href="tel:${c.phone}" class="contact-btn">Call</a>` : ''}
                        <button class="action-btn" onclick="editContact(${c.id})">✏️</button>
                        <button class="action-btn delete-btn" onclick="deleteContact(${c.id})">🗑️</button>
                    </div>`;
                container.appendChild(item);
            });
        }
        function addOrUpdateContact() { const name = document.getElementById('contactName').value.trim(); const role = document.getElementById('contactRole').value.trim(); const email = document.getElementById('contactEmail').value.trim(); const phone = document.getElementById('contactPhone').value.trim(); const id = parseInt(document.getElementById('contactEditId').value); if (!name || !role) { alert('Name and Role are required.'); return; } if (id) { const contact = appData.contacts.find(c => c.id === id); Object.assign(contact, { name, role, email, phone }); } else { appData.contacts.push({ id: Date.now(), name, role, email, phone }); } resetContactForm(); saveData(); renderContacts(); }
        function editContact(id) { const c = appData.contacts.find(c => c.id === id); document.getElementById('contactFormTitle').innerText = 'Edit Contact'; document.getElementById('contactEditId').value = c.id; document.getElementById('contactName').value = c.name; document.getElementById('contactRole').value = c.role; document.getElementById('contactEmail').value = c.email; document.getElementById('contactPhone').value = c.phone; document.getElementById('contactSubmitBtn').innerText = 'Update Contact'; document.getElementById('contactName').focus(); }
        function deleteContact(id) { if (confirm('Delete this contact?')) { appData.contacts = appData.contacts.filter(c => c.id !== id); saveData(); renderContacts(); } }
        function resetContactForm() { document.getElementById('contactFormTitle').innerText = 'Add New Contact'; document.getElementById('contactSubmitBtn').innerText = 'Add Contact'; document.getElementById('contactEditId').value = ''; document.getElementById('contactName').value = ''; document.getElementById('contactRole').value = ''; document.getElementById('contactEmail').value = ''; document.getElementById('contactPhone').value = ''; }
        
        // --- NOTIFICATIONS / ALERTS (Unchanged) ---
        function renderNotifications() { const container = document.getElementById('notificationsList'); container.innerHTML = appData.notifications.length === 0 ? `<div class="empty-state">No alerts.</div>` : ''; [...appData.notifications].sort((a, b) => new Date(a.date) - new Date(b.date)).forEach(n => { const item = document.createElement('div'); item.className = 'list-item notification'; const date = new Date(n.date); const isOverdue = date < new Date(); item.innerHTML = ` <div class="item-actions"> <button class="action-btn" onclick="editReminder(${n.id})">✏️</button> <button class="action-btn delete-btn" onclick="deleteReminder(${n.id})">🗑️</button> </div> <div class="notification-header"> ${n.title} <span class="badge" style="background: ${isOverdue ? '#e53e3e' : '#667eea'};">${isOverdue ? 'Overdue' : 'Upcoming'}</span> </div> <div class="notification-text"> <strong>Due:</strong> ${date.toLocaleDateString()} at ${date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}<br> ${n.note} </div>`; container.appendChild(item); }); }
        function addOrUpdateReminder() { const title = document.getElementById('reminderTitle').value.trim(); const date = document.getElementById('reminderDate').value; const note = document.getElementById('reminderNote').value.trim(); const id = parseInt(document.getElementById('reminderEditId').value); if (!title || !date) { alert('Title and Date are required.'); return; } if (id) { const reminder = appData.notifications.find(n => n.id === id); Object.assign(reminder, { title, date, note }); } else { appData.notifications.push({ id: Date.now(), title, date, note }); } resetReminderForm(); saveData(); renderNotifications(); }
        function editReminder(id) { const reminder = appData.notifications.find(n => n.id === id); document.getElementById('reminderFormTitle').innerText = 'Edit Reminder'; document.getElementById('reminderSubmitBtn').innerText = 'Update Reminder'; document.getElementById('reminderEditId').value = reminder.id; document.getElementById('reminderTitle').value = reminder.title; document.getElementById('reminderDate').value = reminder.date; document.getElementById('reminderNote').value = reminder.note; document.getElementById('reminderTitle').focus(); }
        function deleteReminder(id) { if (confirm('Delete this reminder?')) { appData.notifications = appData.notifications.filter(n => n.id !== id); saveData(); renderNotifications(); } }
        function resetReminderForm() { document.getElementById('reminderFormTitle').innerText = 'Add Reminder'; document.getElementById('reminderSubmitBtn').innerText = 'Set Reminder'; document.getElementById('reminderEditId').value = ''; document.getElementById('reminderTitle').value = ''; document.getElementById('reminderDate').value = ''; document.getElementById('reminderNote').value = ''; }
        
        // --- STARTUP & PWA REGISTRATION (Unchanged) ---
        document.addEventListener('DOMContentLoaded', init);
    </script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('Service Worker registered successfully'))
                    .catch(error => console.log('Service Worker registration failed:', error));
            });
        }
    </script>
</body>
</html>